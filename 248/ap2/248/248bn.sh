#! /bin/bash

awk '
BEGIN {
	print "#B dB H dH"
}

/^[^#]/ {
	OFMT = "%.3g"
	$2 = $2 * 10^-3
	dN = 2; dD = 0.001; dI = $1 * 0.025; dB = $2 * 0.03; dL = 0.02
	H = (((500 * $1) / 0.5) - (0.002 / (4 * 3.14 * 10^-7 * 0.5))) * $2
	x1 = ($1 * dN) / 0.5; x2 = ($2 * dD) / (4 * 3.14 * 10^-7 * 0.5)
	x3 = ((500 * dI) / 0.5); x4 = (0.002 * dB) / (4 * 3.14 * 10^-7 * 0.5)
	x5 = ((-(500 * $1) / 0.25) + ((0.002 * $2) / (4 * 3.14 * 10^-7 * 0.25))) * dL
	dH = sqrt(x1^2 + x2^2 + x3^2 + x4^2 + x5^2)

	print $2, dB, H, dH
}' $1 | sed 's/,/\./g; s/ /\t/g'
